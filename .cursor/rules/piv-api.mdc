---
description: PIV API design rules for controllers and routes
globs: ["*Controller*", "*Router*", "*Route*", "routes/*", "controllers/*", "*Handler*"]
alwaysApply: false
---

# API Design Rules

## Workflow

1. **Write API test FIRST** (TDD applies to APIs too)
2. **Define request/response contract** before implementing
3. **Implement ONE endpoint** → test → confirm → then next

## RESTful Principles

- **Nouns over verbs**: `/users` not `/getUsers`
- **Plural nouns**: `/users` not `/user`
- **HTTP verbs**: GET (read), POST (create), PUT (update), DELETE (remove)
- **Resource hierarchy**: `/users/{id}/posts`

## Response Format

```json
// Success
{ "data": {...}, "meta": {...} }

// Error
{ "error": "ErrorCode", "message": "Human-readable description" }
```

## HTTP Status Codes

| Code | Use Case |
|------|----------|
| 200 | Success (GET, PUT, PATCH) |
| 201 | Created (POST) |
| 400 | Bad Request (validation) |
| 401 | Unauthorized |
| 404 | Not Found |
| 500 | Server Error |

## Best Practices

- Validate all input (body, params, query)
- Version your API (`/v1/users`)
- Implement rate limiting on public endpoints

<!-- PIV Spec-Kit v2.1.0 -->
