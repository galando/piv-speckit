---
description: PIV security rules for authentication and security code
globs: ["*Auth*", "*Security*", "*Password*", "*Token*", "*Credential*", "*Session*"]
alwaysApply: false
---

# Security Rules

## Golden Rule

**NEVER trust user input.**

Validate EVERYTHING: form submissions, API requests, file uploads, URL params, webhooks.

## Input Validation

- ✅ Validate structure, type, format, length, range
- ✅ Sanitize data before use
- ✅ Use parameterized queries (prevent SQL injection)
- ✅ Escape output (prevent XSS)

## Authentication & Passwords

```javascript
// ❌ FORBIDDEN - Never use for passwords
MD5, SHA1, SHA256, SHA512

// ✅ REQUIRED - Use password hashing
bcrypt, argon2, scrypt
```

- Strong JWT secrets (256+ bits)
- Token expiration ≤1 hour
- Implement rate limiting on auth endpoints

## Data Protection

- ✅ HTTPS in production
- ✅ Encrypt sensitive data at rest
- ✅ Environment variables for secrets
- ❌ NEVER commit secrets to git
- ❌ NEVER log sensitive data

<!-- PIV Spec-Kit v2.1.0 -->
